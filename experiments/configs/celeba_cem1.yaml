trials: 1
results_dir: results/celeba_complete_cem1/

shared_params:
  results_dir: "results/celeba_complete_cem1/"
  trials: 1
  model_selection_trials: 1
  dataset_config:
    dataset: "celeba"
    image_size: 64
    num_classes: 1000
    batch_size: 512
    root_dir: "cem/data/CelebA" # REPLACE ME
    use_imbalance: true
    use_binary_vector_class: true
    num_concepts: 8
    label_binary_width: 1
    label_dataset_subsample: 12
    num_hidden_concepts: 0
    selected_concepts: false
    num_workers: 8
  intervention_config:
    competence_levels: [1]
    intervention_freq: 1
    intervention_batch_size: 256
    val_intervention_policies:
      - policy: "random"
        group_level: true
        use_prior: false
    intervention_policies:
      - policy: "random"
        group_level: true
        use_prior: false
      # Remove the following if you are only interested in random interventions
      - policy: "random"
        group_level: true
        use_prior: true
        include_run_names: [".*(CEM).*"]
#      - policy: "coop"
#        group_level: true
#        use_prior: False
#      - policy: "behavioural_cloning"
#        group_level: true
#        use_prior: False
#      - policy: "optimal_greedy"
#        group_level: true
#        use_prior: False
#      - policy: "global_val_error"
#        group_level: true
#        use_prior: False
#      - policy: "global_val_improvement"
#        group_level: true
#        use_prior: False
      ##########################################################################
  eval_config:
    additional_metrics: []
    additional_test_sets: []

  skip_repr_evaluation: true
  save_model: true
  max_epochs: 150
  lr_scheduler_patience: 10
  patience: 5
  emb_size: 16
  extra_dims: 0
  concept_loss_weight: [1, 10]
  learning_rate: 0.005
  weight_decay: 4.0e-06
  weight_loss: false
  c_extractor_arch: "resnet34"
  optimizer: "sgd"
  bool: false
  early_stopping_monitor: "val_loss"
  early_stopping_mode: "min"
  early_stopping_delta: 0.0
  momentum: 0.9
  sigmoidal_prob: false
  training_intervention_prob: 0.25
runs:

  - architecture: "ConceptEmbeddingModel"
    run_name: "CEM"
    emb_size: 32
    concept_loss_weight: 10
    sigmoidal_prob: true
    embedding_activation: "leakyrelu"





